<!DOCTYPE html>
<html>
  <head>
    <title>Widget. Accepts form as URL parameter</title>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet" />
    <style>
      body {
        font-family: sans-serif;
        font-size: 15px;
        padding: 50px;
      }

      .parameter {
        font-weight: 700;
        font-style: italic;
      }

      .demo-url {
        font-style: italic;
        color: #999;
      }
    </style>
  </head>

  <body>
    <div
      class="typeform-widget"
      data-url="//betatests.typeform.com/to/Z9k3bK"
      style="width:100%; height:500px;"
    ></div>

    <script>
      (function() {
        var DEFAULT_FORM_URL = "//betatests.typeform.com/to/Z9k3bK";

        var getUrlVars = function() {
          var vars = {};
          var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {
            vars[key] = value;
          });
          return vars;
        };

        var getUrlParam = function(parameter, defaultvalue) {
          var urlparameter = defaultvalue;
          if (window.location.href.indexOf(parameter) > -1) {
            urlparameter = getUrlVars()[parameter];
          }
          return urlparameter;
        };

        var getEmbedVersion = function() {
          var embedVersion = getUrlParam("embedVersion", "");
          return embedVersion ? embedVersion + "/" : "";
        };

        var getFormURL = function() {
          if (window.location.href.indexOf("formURL") > -1) {
            return getUrlVars()["formURL"];
          }
          if (window.location.href.indexOf("formId") > -1) {
            return "https://admin.typeform.com/to/" + getUrlVars()["formId"];
          }
          return DEFAULT_FORM_URL;
        };

        var qs, js, q, s, d = document, gi = d.getElementById, ce = d.createElement, gt = d.getElementsByTagName, id = "typef_orm";
        var b = "https://embed.typeform.com/" + getEmbedVersion();
        if (!gi.call(d, id)) {
          js = ce.call(d, "script");
          js.id = id;
          js.src = b + "embed.js";
          q = gt.call(d, "script")[0];
          console.log(q.parentNode);
          document.getElementsByClassName("typeform-widget")[0].setAttribute("data-url", getFormURL());
          q.parentNode.insertBefore(js, q);
        }
      })();
    </script>

    <div style="font-family: Sans-Serif;font-size: 12px;color: #999;opacity: 0.5; padding-top: 5px;">
      powered by
      <a
        href="https://admin.typeform.com/signup?utm_campaign=twyecv&utm_source=typeform.com-01E0WHTNDVH5PMHDRYE2K8RTJA-premium&utm_medium=typeform&utm_content=typeform-embedded-poweredbytypeform&utm_term=EN"
        style="color: #999"
        target="_blank"
        >Typeform</a
      >
    </div>

    <p>
      This demo page allows testing a specific form with a specific embed library version. To do that you can provide
      the following URL parameters to this page:
    </p>

    <ul>
      <li>
        <p>
          <span class="parameter">formId</span>. The form id.<br />
          E.g. <span class="demo-url">?formId=twyecv</span>
        </p>
      </li>
    </ul>

    <ul>
      <li>
        <p>
          <span class="parameter">formURL</span>. The full form URL.<br />
          E.g. <span class="demo-url">?formURL=https://lluisfons423103.typeform.com/to/A6mJIq</span><br />
          If a formURL parameter and a formId one are provided in the same URL, formURL parameter will override formId.
        </p>
      </li>
    </ul>

    <ul>
      <li>
        <p>
          <span class="parameter">embedVersion</span>. The version of the embed library.<br />
          E.g. <span class="demo-url">?embedVersion=85ecd5507736783755003760756a667274778317</span>
        </p>

        <ul>
          <li>
            A new version of the library is automatically generated by Travis CI every time a new Pull Request to the
            embed project is created. That version number is posted as a BOT comment on the GitHub pull request page.
          </li>
          <li>
            Please note that it is also possible to test different versions of the embed library using URLs that follow
            this pattern: <span class="demo-url">http://embed.typeform.com/{VERSION_HASH}/index.html</span>.<br />
            E.g.
            <span class="demo-url">http://embed.typeform.com/4c088d41c0ed9ade18d0650742795a3b595f3c88/index.html</span>
          </li>
        </ul>
      </li>
    </ul>

    <hr />

    <p>
      This demo page should accept any combination of a valid <span class="parameter">embedVersion</span> and a valid
      <span class="parameter">formId</span>/<span class="parameter">formURL</span>.
    </p>
    <p>
      For example, we can test a form that contains a videoAsk block (<span class="demo-url"
        >https://orioltorrillas.typeform.com/to/RrMqnU</span
      >) with an earlier version of the embed library (<span class="demo-url"
        >85ecd5507736783755003760756a667274778317</span
      >). <br />
      This version of the library did not support answering the videoask using the mic or the camera, so it shows us the
      "Answer on videoask.com" button.<br />
      <span class="demo-url"
        >?formURL=https://orioltorrillas.typeform.com/to/RrMqnU&embedVersion=85ecd5507736783755003760756a667274778317</span
      >
    </p>

    <p>
      However, if we try the same form but with the updated version of the library: <br />
      <span class="demo-url"
        >?formURL=https://orioltorrillas.typeform.com/to/RrMqnU&embedVersion=529ed29e7d2f700acbd94a02fd0570e029919eec</span
      ><br />
      We can observe that we can answer the videoask block directly from the embedded form itself!
    </p>
  </body>
</html>
